{#- builds vpns dict #}
{%- set ns = namespace(found=false) %}
{%- set vpns = dict() %}
{%- set _dummy = vpns.setdefault("evpn", {}) %}
{%- set _dummy = vpns.setdefault("l2vpn", {}) %}
{#- iterate through all interfaces that are part of a bridge domain #}
{%- for iface in device.interfaces.filter(bridge__isnull=false, l2vpn_terminations__isnull=false) %}
{%-		set evi = interface.l2vpn_termination %}
{%- 	set bundle_id = interface.parent.name | regex_replace('[^0-9]', '') %}
{%- 	set bundle_id_with_dot = bundle_id[:2] ~ '.' ~ bundle_id[2:] %}

bundle_id: {{ bundle_id }}
bundle_id_with_dot: {{ bundle_id_with_dot }}

{%- endfor %}